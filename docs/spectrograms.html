<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>spectrograms.knit</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BOKU bioacoustics R 2022</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="program.html">Program</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_basics.html">R basics</a>
    </li>
    <li>
      <a href="sound.html">Sound</a>
    </li>
    <li>
      <a href="spectrograms.html">Spectrograms</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Building spectrograms</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="4"><b>Analysis of animal acoustic signals in R</b> <br> BOKU International wildlife lectures, 2022</font>
</center></h3>
<h4 class="author"><center>
<font size="3"><a href="http://marceloarayasalas.weebly.com/">Marcelo Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-03-09”
</center></h4>

</div>


<p> </p>
<p>The spectrogram is a fundamental tool in the study of acoustic communication in vertebrates. They are basically a visual representation of the sound where the variation in energy (or power spectral density) is shown on both the frequency and the time domains. Spectrograms allow us to visually explore acoustic variation in our study systems, which makes it easy to distinguish structural differences at small temporal/spectral scales that our ears cannot detect.</p>
<p>We will use the <strong>seewave</strong> package and its sample data:</p>
<pre class="r"><code>library(seewave)

# load examples
data(tico)

data(orni)</code></pre>
<div id="fourier-transformation" class="section level2">
<h2>Fourier transformation</h2>
<p>In order to understand the information contained in a spectrogram it is necessary to understand, at least briefly, the <a href="https://en.wikipedia.org/wiki/Fourier_transform">Fourier transformation</a>. In simple words, this is a mathematical transformation that detects the periodicity in time series, identifying the different frequencies that compose them and their relative energy. Therefore it is said that it transforms the signals from the time domain to the frequency domain.</p>
<p>To better understand how it works, we can simulate time series composed of pre-defined frequencies. In this example we simulate 3 frequencies and join them in a single time series:</p>
<pre class="r"><code># freq
f &lt;- 11025

# time sequence
t &lt;- seq(1/f, 1, length.out=f)

# period
pr &lt;- 1/440
w0 &lt;- 2 * pi/pr

# frec 1
h1 &lt;- 5 * cos(w0*t)

plot(h1[1:75], type = &quot;l&quot;, col = &quot;blue&quot;, xlab = &quot;Time (samples)&quot;, ylab = &quot;Amplitude (no units)&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code># frec 2
h2 &lt;- 10 * cos(2 * w0 * t)

plot(h2[1:75], type = &quot;l&quot;, col = &quot;blue&quot;, xlab = &quot;Time (samples)&quot;, ylab = &quot;Amplitude (no units)&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code># frec 3
h3 &lt;- 15 * sin(3 * w0 * t)

plot(h3[1:75], type = &quot;l&quot;, col = &quot;blue&quot;, xlab = &quot;Time (samples)&quot;, ylab = &quot;Amplitude (no units)&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<p>This is what the union of the three frequencies looks like:</p>
<pre class="r"><code>H0 &lt;- 0.5 + h1 + h2 + h3

plot(H0[1:75], type = &quot;l&quot;, col = &quot;blue&quot;, xlab = &quot;Time (samples)&quot;, ylab = &quot;Amplitude (no units)&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Now we can apply the Fourier transform to this time series and graph the frequencies detected using a periodogram:</p>
<pre class="r"><code>fspc &lt;- Mod(fft(H0))

plot(fspc, type=&quot;h&quot;, col=&quot;blue&quot;,
xlab=&quot;Frecuency (Hz)&quot;,
ylab=&quot;Amplitude (no units)&quot;)

abline(v = f / 2, lty = 2)

text(x = (f / 2) + 1650, y = 8000, &quot;Nyquist Frequency&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We can make zoom in to frequencies below the Nyquist frequency:</p>
<pre class="r"><code>plot(fspc[1:(length(fspc) / 2)], type=&quot;h&quot;, col=&quot;blue&quot;,
xlab=&quot;Frecuency (Hz)&quot;,
ylab=&quot;Amplitude (no units)&quot;)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>This diagram (taken from Sueur 2018) summarizes the process we just simulated:</p>
<p><img src="images/FFT_decomp.png" width="400px" style="display: block; margin: auto;" /> <font size="1"><b>Tomado de Sueur 2018</b></font></p>
<p>The periodogram next to the spectrogram of these simulated sounds looks like this:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p> </p>
</div>
<div id="from-the-fourier-transformation-to-the-spectrogram" class="section level2">
<h2>From the Fourier transformation to the spectrogram</h2>
<p>The spectrograms are constructed of the spectral decomposition of discrete time segments of amplitude values. Each segment (or window) of time is a column of spectral density values in a frequency range. Take for example this simple modulated sound, which goes up and down in frequency:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-7-1.png" width="672" />  </p>
<p>If we divide the sound into 10 segments and make periodograms for each of them we can see this pattern in the frequencies:</p>
<p><img src="images/periodogram_spectro.gif" alt="Spectrogram resolution"></p>
<p>This animation shows in a very simple way the logic behind the spectrograms: if we calculate Fourier transforms for short segments of time through a sound (e.g. amplitude changes in time) and concatenate them, we can visualize the variation in frequencies over time.  </p>
</div>
<div id="overlap" class="section level2">
<h2>Overlap</h2>
<p>When frequency spectra are combined to produce a spectrogram, the frequency and amplitude modulations are not gradual:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-10-1.png" width="672" />  </p>
<p>There are several “tricks” to smooth out the contours of signals with high modulation in a spectrogram, although the main and most common is window overlap. The overlap recycles a percentage of the amplitude samples of a window to calculate the next window. For example, the sound used as an example, with a window size of 512 points divides the sound into 15 segments:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>A 50% overlap generates windows that share 50% of the amplitude values with the adjacent windows. This has the visual effect of making modulations much more gradual:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Which increases (in some way artificially) the number of time windows, without changing the resolution in frequency. In this example, the number of time windows is doubled:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Therefore, the greater the overlap the greater the smoothing of the contours of the sounds:</p>
<p><img src="images/spectro.overlap.gif" alt="Spectrogram overlap"></p>
<p>This increases the number of windows as a function of the overlap for this particular sound:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p> </p>
<p>This increase in spectrogram sharpness does not come without a cost. The longer the time windows, the greater the number of Fourier transformations to compute, and therefore, the greater the duration of the process. This graphic shows the increase in duration as a function of the number of windows on my computer:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p> </p>
<p>It is necessary to take this cost into account when producing spectrograms of long sound files (&gt; 1 min).</p>
<p> </p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>However, there is a trade-off between the resolution between the 2 domains: the higher the frequency resolution, the lower the resolution in time. The following animation shows, for the sound of the previous example, how the resolution in frequency decreases as the resolution in time increases:</p>
<p><img src="images/spectro.precision.tradeoff2.gif" alt="Spectrogram resolution 2"></p>
<p> </p>
<p>This is the relationship between frequency resolution and time resolution for the example signal:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-19-1.png" width="672" />  </p>
<p> </p>
</div>
<div id="creating-spectrograms-in-r" class="section level2">
<h2>Creating spectrograms in R</h2>
<p>There are several R packages with functions that produce spectrograms in the graphical device. This chart (taken from Sueur 2018) summarizes the functions and their arguments: <img src="images/r-spectrogram-funs.png" alt="Spectrogram functions"></p>
<p> </p>
<p>We will focus on making spectrograms using the <code>spectro ()</code> function of <strong>seewave</strong>:</p>
<pre class="r"><code>tico2 &lt;- cutw(tico, from = 0.55, to = 0.9, output = &quot;Wave&quot;)

spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = FALSE)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li><p>How can I increase the overlap between time windows?</p></li>
<li><p>How much longer it takes to create a 99%-overlap spectrogram compare to a 5%-overlap spectrogram?</p></li>
<li><p>What does the argument ‘collevels’ do? Increase the range and look at the spectrogram.</p></li>
<li><p>What do the ‘flim’ and ‘tlim’ arguments determine?</p></li>
<li><p>Run the examples that come in the <code>spectro()</code> function documentation</p></li>
</ul>
</div>
<p> </p>
<p>Almost all components of a spectrogram in <strong>seewave</strong> can be modified. We can add scales:</p>
<pre class="r"><code>spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = TRUE)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Change the color palette:</p>
<pre class="r"><code>spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = TRUE,
          palette = reverse.cm.colors)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = TRUE,
          palette = reverse.gray.colors.1)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Remove the vertical lines:</p>
<pre class="r"><code>spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = TRUE,
          palette = reverse.gray.colors.1,
        grid = FALSE)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Add oscillograms (waveforms):</p>
<pre class="r"><code>spectro(tico2,  f = 22050, wl = 512, ovlp = 90,
        collevels = seq(-40, 0, 0.5),
        flim = c(2, 6), scale = TRUE,
          palette = reverse.gray.colors.1,
        grid = FALSE, 
        osc = TRUE)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Use contours instead of colors:</p>
<pre class="r"><code>blanc &lt;- colorRampPalette(&quot;white&quot;)

spectro(tico2, contlevels=seq(-30, 0, 4),
cont=TRUE, colcont=temp.colors(8),
palette=blanc, scale=FALSE,  flim = c(2, 6))</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li><p>Change the color of the oscillogram to a ‘heat color’ palette</p></li>
<li><p>These are some of the color palettes that fit well the gradients in spectrograms:  </p></li>
</ul>
<center>
<img src="images/palletes.png" alt="Spectrogram palletes" width="480">
</center>
<p><font size="1"><b>From Sueur 2018</b></font></p>
<p> </p>
<p>Use at least 3 palettes to generate the “tico2” spectrogram</p>
<p> </p>
<ul>
<li><p>Change the relative height of the oscillogram so that it corresponds to 1/6 of the height of the spectrogram</p></li>
<li><p>Change the relative width of the amplitude scale so that it corresponds to 1/8 of the spectrogram width</p></li>
<li><p>What does the “zp” argument do? (hint: try <code>zp = 100</code> and notice the effect on the spectrogram)</p></li>
<li><p>Which value of “wl” (window size) generates smoother spectrograms for the example “orni” object?</p></li>
</ul>
</div>
<p> </p>
<p>The <code>spectrogram()</code> function of the <strong>soundgen</strong> package produces spectrograms slightly different from those of other packages:</p>
<pre class="r"><code>library(soundgen)</code></pre>
<pre><code>## Loading required package: shinyBS</code></pre>
<pre><code>## Soundgen 2.2.0. Tips &amp; demos on project&#39;s homepage: http://cogsci.se/soundgen.html</code></pre>
<pre class="r"><code>spectrogram(x = as.numeric(tico2@left), samplingRate = tico2@samp.rate, windowLength = 30, overlap = 90, ylim = c(2, 6))</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-27-1.png" width="672" />  </p>
<p>It also allows you to use spectral derivatives to produce spectrograms (similar to the program <a href="http://soundanalysispro.com/"><em>Sound Analysis Pro</em></a>):</p>
<pre class="r"><code>spectrogram(x = as.numeric(tico2@left), 
            samplingRate = tico2@samp.rate, windowLength = 30,
            overlap = 90, method = &quot;spectralDerivative&quot;, 
            ylim = c(2, 6))</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-28-1.png" width="672" />  </p>
<p>It has a large number of arguments that allow modification of the color and “resolution”. For instance, we can change the brightness:</p>
<pre class="r"><code>spectrogram(x = as.numeric(tico2@left), 
            samplingRate = tico2@samp.rate, 
            windowLength = 30, overlap = 90, 
            ylim = c(2, 6), brightness = -0.1)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-29-1.png" width="672" />  </p>
<p>Or apply smoothing in frequency and time (‘smoothTime’ and smoothFreq’):</p>
<pre class="r"><code>spectrogram(x = as.numeric(tico2@left), 
            samplingRate = tico2@samp.rate, 
            windowLength = 30, overlap = 90, ylim = c(2, 6), 
            smoothFreq = 5,  smoothTime = 5)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-30-1.png" width="672" />  </p>
<p>The <strong>monitoR</strong> package provides the <code>ViewSpec()</code> function to generate spectrograms:</p>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>library(monitoR)

viewSpec(tico2, main = NA, frq.lim = c(2, 6), ovlp = 90)</code></pre>
<p> </p>
<p>The arguments are very similar to those of <code>spectro()</code> of <strong>seewave</strong> since <code>ViewSpec()</code> uses that function internally.</p>
<p>Other options are <code>specgram()</code> of <strong>signal</strong>:</p>
<pre class="r"><code>library(signal)

specgram(tico2@left, n = 512, Fs = 8000, overlap = round(512 * 0.9))</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-33-1.png" width="672" />  </p>
<p><code>spectrogram()</code> from <strong>phonTools</strong>:</p>
<pre class="r"><code>library(phonTools)

phonTools::spectrogram(tico2@left, fs = tico2@samp.rate, maxfreq = 6000, windowlength = round(length(tico2@left) / 512))</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-34-1.png" width="672" />  </p>
<p><code>powS()</code> of <strong>tuneR</strong> does not generate the display, it only calculates the spectrogram (i.e. the matrix of amplitude values in time and frequency). To visualize it, use the <code>image()</code> function and add the axes manually:</p>
<pre class="r"><code>library(tuneR)

# calcular espectrograma
ps &lt;- powspec(tico2@left, sr = tico2@samp.rate,
wintime = 512 / f, steptime = 0.25 * 512 / tico2@samp.rate)

# normalizar
ps &lt;- ps / max(ps)

# pasar a dB
ps &lt;- 10*log10(ps)

# graficar
image(t(ps), col = gray((512:0) / 512),
xlab = &quot;Time (s)&quot;, ylab = &quot;Frequency (Hz)&quot;, # axes labels
axes=FALSE)

# añadir ejes manualmente
time &lt;- round(seq(0, duration(tico2), length=5), 1)

frequency &lt;- round(seq(tico2@samp.rate/512, tico2@samp.rate/2, length=5))

axis(side=1, at=seq(0, 1,length=5), labels = time)

axis(side=2, at=seq(0, 1,length=5), labels = frequency)</code></pre>
<p><img src="spectrograms_files/figure-html/unnamed-chunk-35-1.png" width="672" />  </p>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li><p>Pick up an example acoustic signal from your own research and make a spectrogram</p></li>
<li><p>Improve the visualization by optimizing the parameters ‘wl’, ‘collevels’, ‘palette’ and ‘overlap’</p></li>
</ul>
</div>
<p> </p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li><p>Sueur J, Aubin T, Simonis C. 2008. Equipment review: seewave, a free modular tool for sound analysis and synthesis. Bioacoustics 18(2):213–226.</p></li>
<li><p>Sueur, J. (2018). Sound Analysis and Synthesis with R.</p></li>
</ol>
<hr />
<p> </p>
<p><font size="4">Session information</font></p>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    
##  [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] tuneR_1.3.3.1     phonTools_0.2-2.1 signal_0.7-7      soundgen_2.2.0   
## [5] shinyBS_0.61      seewave_2.1.8    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.8       bslib_0.2.5.1    compiler_4.1.1   later_1.3.0     
##  [5] jquerylib_0.1.4  highr_0.9        tools_4.1.1      digest_0.6.29   
##  [9] jsonlite_1.7.2   evaluate_0.14    lifecycle_1.0.1  lattice_0.20-44 
## [13] rlang_1.0.1      shiny_1.6.0      cli_3.1.0        rstudioapi_0.13 
## [17] yaml_2.2.2       xfun_0.29        fastmap_1.1.0    stringr_1.4.0   
## [21] knitr_1.37       sass_0.4.0       grid_4.1.1       R6_2.5.1        
## [25] rmarkdown_2.10   monitoR_1.0.7    magrittr_2.0.2   promises_1.2.0.1
## [29] htmltools_0.5.2  ellipsis_0.3.2   MASS_7.3-54      mime_0.11       
## [33] xtable_1.8-4     httpuv_1.6.2     stringi_1.7.6    zoo_1.8-9</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
