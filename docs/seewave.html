<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>seewave.knit</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BOKU bioacoustics R 2022</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="program.html">Program</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_basics.html">R basics</a>
    </li>
    <li>
      <a href="sound.html">Sound</a>
    </li>
    <li>
      <a href="spectrograms.html">Spectrograms</a>
    </li>
    <li>
      <a href="seewave.html">seewave</a>
    </li>
    <li>
      <a href="annotations.html">Annotations</a>
    </li>
    <li>
      <a href="intro_to_warbler.html">Intro to warbleR</a>
    </li>
    <li>
      <a href="ohun.html">ohun: automatic detection</a>
    </li>
    <li>
      <a href="measure_acoustic_structure.html">Measure acoustic structure</a>
    </li>
    <li>
      <a href="comparing_methods.html">Comparing measuring methods</a>
    </li>
    <li>
      <a href="quality_checks.html">Quality checks</a>
    </li>
  </ul>
</li>
<li>
  <a href="course_prep.html">Course prep</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Seewave</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="4"><b>Analysis of animal acoustic signals in R</b> <br> BOKU International Wildlife Lectures</font>
</center></h3>
<h4 class="author"><center>
<font size="3"><a href="http://marceloarayasalas.weebly.com/">Marcelo Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-03-10”
</center></h4>

</div>


<p> </p>
<p><strong>seewave</strong> provides a wide variety of tools to accurately assess sound properties in the R environment. It is an extensive package with lots of features. The package allows to visualize and measure characteristics of time, frequency and amplitude of sounds. The tools are arranged in a modular way (each analysis in its own function) which allows combining them to generate more elaborate analyzes.</p>
<p>The majority of the functions of <strong>seewave</strong> work on wave objects (but not on audio files in folders). Here we will see examples of some of these tools, focusing on those that are potentially more useful for the study of vocal behavior in animals.</p>
<p>First we must load the package:</p>
<pre class="r"><code>library(seewave)</code></pre>
<p>We can see the description of the package <strong>seewave</strong> in this way:</p>
<pre class="r"><code>?seewave</code></pre>
<div id="example-data-in-seewave" class="section level3">
<h3>Example data in seewave</h3>
<p><strong>seewave</strong> brings several objects that we can use as an example to explore its functions. We can call them with the <code>data ()</code> function:</p>
<pre class="r"><code># cargar ejemplos
data(tico)

data(orni)

data(sheep)</code></pre>
<p> </p>
<div class="alert alert-warning">
<p>⚠ <code>data()</code> only works to load examples that come with the packages by default, not to load your own audio files!!</p>
</div>
<p> </p>
<p>We can see the information of each of them using <code>?</code>:</p>
<pre class="r"><code>?tico</code></pre>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p>What kind of object is <code>tico</code>?</p>
<p>What is the sampling rate and duration?</p>
</div>
<p> </p>
</div>
<div id="oscillograms" class="section level2">
<h2>Oscillograms</h2>
<p>You can create the oscillogram of the entire “wave” object like this:</p>
<pre class="r"><code>oscillo(tico) </code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We can also generate it for a segment:</p>
<pre class="r"><code>oscillo(tico, from = 0, to = 1)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The visualizations in <strong>seewave</strong> allow a high degree of customization. For example change the color:</p>
<pre class="r"><code>oscillo(tico, from = 0, to = 1, colwave = &quot;blue&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Divide the graphic window into several panels:</p>
<pre class="r"><code>oscillo(tico, f = 22050, k = 2, j = 2, byrow = TRUE)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Many other components of the chart can be modified, for example:</p>
<pre class="r"><code># grey background
op &lt;- par(bg = &quot;grey&quot;)

oscillo(tico, f = 22050, k = 4 , j = 1,
        title = TRUE,
        colwave = &quot;black&quot;, 
        coltitle = &quot;yellow&quot;,
        collab = &quot;red&quot;,
        colline = &quot;white&quot;,
        colaxis = &quot;blue&quot;,
        coly0 = &quot;grey50&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p> </p>
<p>We can also generate other representations of “amplitude vs. time”, such as “amplitude envelopes”:</p>
<pre class="r"><code>env(tico, f = 22050, colwave = &quot;blue&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We can superimpose it on the oscillogram to facilitate comparison:</p>
<pre class="r"><code>oscillo(tico, f = 22050)

par(new=TRUE)

env(tico, f = 22050, colwave = &quot;blue&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p> </p>
<div class="alert alert-success">
<center>
<font size="3"><b>Sliding window for time series</b></font>
</center>
<p> </p>
<p>Sliding windows allow you to smooth out the contours of a time series by calculating an average value around the “neighborhood” of values for a given value. In the case of amplitude envelope the size of the “neighborhood” is given by the length of the window (“wl”). The larger the window length, the greater the smoothing of the curve:</p>
<p> </p>
<center>
<img src="images/env_sliding_window_ENG.gif" alt="Sliding window">
</center>
<p> </p>
<p>This animation shows how the amplitude envelope of the “tico” object is smoothed with a 512-point window:</p>
<p> </p>
<center>
<img src="images/env_sliding_window_scheme_ENG512.gif" alt="Sliding window">
</center>
<p> </p>
<p>… or a 1024 point window:</p>
<p> </p>
<center>
<img src="images/env_sliding_window_scheme_ENG1024.gif" alt="Sliding window">
</center>
<p> </p>
</div>
<p> </p>
<p>We can use these amplitude “hills” to define segments in the “wave” object using the <code>timer()</code> function. The “ssmooth” argument allows us to use a sliding window:</p>
<pre class="r"><code>tmr &lt;- timer(orni, f = 22050, threshold = 5, ssmooth = 40, 
             bty = &quot;l&quot;, colval = &quot;blue&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>tmr</code></pre>
<pre><code>## $s
## [1] 6.0140e-02 5.9187e-02 5.1341e-02 4.5354e-05 5.7283e-02 4.5354e-05 6.6671e-03 4.5354e-05
## [9] 4.9663e-02
## 
## $p
##  [1] 2.2088e-02 1.0046e-01 8.2726e-02 2.2677e-04 8.5946e-02 4.5354e-05 8.1320e-02 4.9890e-04
##  [9] 4.5354e-05 6.0684e-02
## 
## $r
## [1] 0.65528
## 
## $s.start
## [1] 0.022088 0.182687 0.324601 0.376169 0.462161 0.519489 0.600854 0.608020 0.608111
## 
## $s.end
## [1] 0.082227 0.241875 0.375942 0.376214 0.519443 0.519534 0.607521 0.608066 0.657774
## 
## $first
## [1] &quot;pause&quot;</code></pre>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li><p>In the previous example using <code>timer()</code> the last pulse is divided into 2 detections, one very small at the beginning and another containing the rest of the pulse. Change the “ssmooth” argument until this section is detected as a single pulse.</p></li>
<li><p>Use the “msmooth” and “ksmooth” arguments to achieve a detection similar to that obtained with “ssmooth”</p></li>
</ul>
</div>
<p> </p>
</div>
<div id="power-spectra" class="section level2">
<h2>Power Spectra</h2>
<p>We can visualize the amplitude in the frequency domain using power spectra. The <code>meanspec()</code> function calculates the average distribution of energy in the frequency range (the average power spectrum):</p>
<pre class="r"><code>mspc &lt;- meanspec(orni, f = 22050, wl = 512, col = &quot;red&quot;)

polygon(rbind(c(0, 0), mspc), col = &quot;red&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>nrow(mspc)</code></pre>
<pre><code>## [1] 256</code></pre>
<p>The <code>spec()</code> function, on the other hand, calculates the spectrum for the entire signal:</p>
<pre class="r"><code>spc &lt;- spec(orni, f=22050, wl=512, col = &quot;red&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>nrow(spc)</code></pre>
<pre><code>## [1] 7921</code></pre>
<p>The result of <code>spec()</code> or <code>meanspec()</code> can be input into the <code>fpeaks()</code> function to calculate amplitude peaks:</p>
<pre class="r"><code>pks &lt;- fpeaks(spc, nmax = 1)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>pks</code></pre>
<pre><code>##        [,1] [,2]
## [1,] 4.8604    1</code></pre>
<p> </p>
<p>.. or into the <code>localpeaks()</code> function to calculate amplitude peaks in different frequency bands:</p>
<pre class="r"><code>pks &lt;- localpeaks(spc, bands = 6)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>pks</code></pre>
<pre><code>##          freq      amp
## [1,] 0.036189 0.027635
## [2,] 2.396800 0.248963
## [3,] 4.860409 1.000000
## [4,] 5.610627 0.322869
## [5,] 7.701215 0.138739
## [6,] 9.225312 0.016284</code></pre>
</div>
<div id="wave-manipulation" class="section level2">
<h2>Wave manipulation</h2>
<p>We can cut segments of a “wave” object:</p>
<pre class="r"><code>tico2 &lt;- cutw(tico, to = 1, output = &quot;Wave&quot;)

oscillo(tico2)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Add segments:</p>
<pre class="r"><code>tico3 &lt;- pastew(tico, tico2, output = &quot;Wave&quot;)

oscillo(tico3)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Remove segments:</p>
<pre class="r"><code>tico4 &lt;- deletew(tico3, output = &quot;Wave&quot;, from = duration(tico), to = duration(tico3))

oscillo(tico4)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Add segments of silence:</p>
<pre class="r"><code>tico5 &lt;- addsilw(tico, at = &quot;end&quot;, d = 1, output = &quot;Wave&quot;)

duration(tico)</code></pre>
<pre><code>## [1] 1.7949</code></pre>
<pre class="r"><code>duration(tico5)</code></pre>
<pre><code>## [1] 2.7949</code></pre>
<p>Remove silence:</p>
<pre class="r"><code>tico6 &lt;- zapsilw(tico5)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li>Create a new wave object with a clip from “tico” that goes from 0.1 to 1.1 s <strong>using base R indexing/subsetting</strong>.</li>
</ul>
</div>
<p> </p>
<p>Filter out frequency bands:</p>
<pre class="r"><code># original
spectro(tico, scale = FALSE, grid = FALSE, flim = c(2, 6))</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># filtered
spectro(ffilter(tico, from = 4000, to = 6500, output = &quot;Wave&quot;), scale = FALSE, grid = FALSE, flim = c(2, 6))</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>Change frequency (pitch):</p>
<pre class="r"><code># cut the first
tico6 &lt;- cutw(tico, from = 0, to = 0.5, output = &quot;Wave&quot;)

# increase frec
tico.lfs &lt;- lfs(tico6, shift = 1000, output = &quot;Wave&quot;)

# decrease frec
tico.lfs.neg &lt;- lfs(tico6, shift = -1000, output = &quot;Wave&quot;)

# 3 column graph
opar &lt;- par()
par(mfrow = c(1, 3))

# original
spectro(tico6, scale = FALSE, grid = FALSE, flim = c(1, 8), main = &quot;original&quot;)

# modified
spectro(tico.lfs, scale = FALSE, grid = FALSE, flim = c(1, 8), main = &quot;1 kHz up&quot;)

spectro(tico.lfs.neg, scale = FALSE, grid = FALSE, flim = c(1, 8), main = &quot;1 kHz down&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>par(opar)</code></pre>
</div>
<div id="measurements" class="section level2">
<h2>Measurements</h2>
<p> </p>
<p>Apart from the measurements of peak frequency (<code>fpeaks()</code>) and duration (<code>timer()</code>), we can measure many other aspects of the acoustic signals using <strong>seewave</strong>. For example, we can estimate the fundamental frequency with the <code>fund()</code> function:</p>
<pre class="r"><code>spectro(sheep, scale = FALSE, grid = FALSE)

par(new=TRUE)

ff &lt;- fund(sheep, fmax = 300, ann = FALSE, threshold=6, col = &quot;green&quot;)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>head(ff)</code></pre>
<pre><code>##            x        y
## [1,] 0.00000       NA
## [2,] 0.06677       NA
## [3,] 0.13354       NA
## [4,] 0.20031       NA
## [5,] 0.26708 0.100000
## [6,] 0.33385 0.071429</code></pre>
<p> </p>
<p>This function uses cepstral transformation to detect the dominant frequency. The <code>autoc()</code> function also measures the fundamental frequency, only using autocorrelation.</p>
<p>Similarly we can measure the dominant frequency:</p>
<pre class="r"><code>par(new=TRUE)

df &lt;- dfreq(sheep, f = 8000, fmax = 300, type = &quot;p&quot;, pch = 24, ann = FALSE, threshold = 6, col = &quot;red&quot;)

head(df)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre><code>##            x       y
## [1,] 0.00000      NA
## [2,] 0.06677      NA
## [3,] 0.13354      NA
## [4,] 0.20031      NA
## [5,] 0.26708 0.48438
## [6,] 0.33385 0.62500</code></pre>
<p> </p>
<p>Measure statistical descriptors of the amplitude distribution in frequency and time:</p>
<pre class="r"><code># cut
note2 &lt;- cutw(tico, from=0.6, to=0.9, output=&quot;Wave&quot;)

n2.as &lt;- acoustat(note2)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>as.data.frame(n2.as[3:8])</code></pre>
<pre><code>##    time.P1  time.M time.P2 time.IPR freq.P1 freq.M
## 1 0.027273 0.10909 0.21818  0.19091  3.4453 4.2636</code></pre>
<p> </p>
<p>Measure statistical descriptors of frequency spectra:</p>
<pre class="r"><code># measure power spectrum
n2.sp &lt;- meanspec(note2, plot = FALSE)

n2.spcp &lt;- specprop(n2.sp, f = note2@samp.rate)

as.data.frame(n2.spcp)</code></pre>
<pre><code>##     mean     sd median    sem   mode    Q25    Q75    IQR   cent skewness kurtosis      sfm      sh
## 1 4346.9 694.26 4306.6 43.391 4349.7 3789.8 4780.4 990.53 4346.9   2.2248   6.6454 0.023993 0.69682
##     prec
## 1 43.066</code></pre>
<p> </p>
<p>Measure the (auto)correlation between 2 amplitude envelopes (time):</p>
<pre class="r"><code># get first note
note1 &lt;- cutw(tico, from=0.1, to=0.4, output=&quot;Wave&quot;)

ce &lt;- corenv(note1, note2, f = 22050)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>ce[-1]</code></pre>
<pre><code>## $rmax
## [1] 0.76321
## 
## $p
## [1] 0
## 
## $t
## [1] -0.21016</code></pre>
<p> </p>
<p>Measure the (auto)correlation between 2 frequency spectra:</p>
<pre class="r"><code># get power spectra
n1.sp &lt;- spec(note1, plot = FALSE)
n2.sp &lt;- spec(note2, plot = FALSE)

csp &lt;- corspec(n1.sp, n2.sp, f = 22050)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code>csp[-1]</code></pre>
<pre><code>## $rmax
## [1] 0.72181
## 
## $p
## [1] 0
## 
## $f
## [1] -0.34672</code></pre>
<p> </p>
<p>Measure spectrographic cross-correlation (auto-correlation between 2 spectrograms):</p>
<pre class="r"><code>cc &lt;- covspectro(note1, note2, f = 22050, n = 11)</code></pre>
<p><img src="seewave_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>cc</code></pre>
<pre><code>## $cov
##  [1] 0.000000 0.122107 0.222531 0.301012 0.459118 0.435812 0.309676 0.175892 0.082271 0.018581
## [11] 0.000000
## 
## $covmax
## [1] 0.45912
## 
## $t
## [1] -0.05</code></pre>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p> </p>
<p>Let’s suppose that we want to know which notes are more similar to each other in the “tico” object. Use the correlation between amplitude frames (<code>corenv()</code>), the correlation between frequency spectra (<code>corspec()</code>) and cross-correlation (<code>covspectro()</code>) to measure the similarity between notes. For simplicity let’s use only the first 3 notes (warning: clips most have exactly the same length).</p>
<p><img src="seewave_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p> </p>
<ul>
<li><p>Which method better reflects the similarity between the notes with respect to the one we observe in the spectrogram?</p></li>
<li><p>Which method produces a similarity that differs more than what we observe in the spectrogram?</p></li>
<li><p>Measure the statistical descriptors of the frequency spectra (function <code>specprop()</code>) on the 3 notes</p></li>
</ul>
</div>
<p> </p>
<hr />
<p><font size="4">Session information</font></p>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C               LC_TIME=es_CR.UTF-8       
##  [4] LC_COLLATE=es_ES.UTF-8     LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] kableExtra_1.3.4   warbleR_1.1.27     NatureSounds_1.0.4 knitr_1.37         seewave_2.2.0     
## [6] tuneR_1.3.3.1     
## 
## loaded via a namespace (and not attached):
##   [1] nlme_3.1-152          bitops_1.0-7          spatstat.sparse_2.1-0 webshot_0.5.2        
##   [5] httr_1.4.2            Deriv_4.1.3           tools_4.1.1           bslib_0.2.5.1        
##   [9] DT_0.19               ohun_0.1.0            vegan_2.5-7           utf8_1.2.2           
##  [13] R6_2.5.1              rpart_4.1-15          mgcv_1.8-36           DBI_1.1.1            
##  [17] colorspace_2.0-3      permute_0.9-5         raster_3.5-11         withr_2.5.0          
##  [21] sp_1.4-6              gridExtra_2.3         tidyselect_1.1.1      moments_0.14         
##  [25] bioacoustics_0.2.8    compiler_4.1.1        soundgen_2.2.0        cli_3.2.0            
##  [29] rvest_1.0.1           formatR_1.11          xml2_1.3.2            microbenchmark_1.4-7 
##  [33] sass_0.4.0            xaringanthemer_0.4.1  scales_1.1.1          spatstat.data_2.1-2  
##  [37] pbapply_1.5-0         proxy_0.4-26          dtw_1.22-3            goftest_1.2-3        
##  [41] systemfonts_1.0.2     stringr_1.4.0         digest_0.6.29         Sim.DiffProc_4.8     
##  [45] shinyBS_0.61          spatstat.utils_2.3-0  rmarkdown_2.10        svglite_2.0.0        
##  [49] pkgconfig_2.0.3       htmltools_0.5.2       PhenotypeSpace_0.1.0  fastmap_1.1.0        
##  [53] highr_0.9             htmlwidgets_1.5.3     rlang_1.0.2           rstudioapi_0.13      
##  [57] xaringan_0.22         baRulho_1.0.6         jquerylib_0.1.4       farver_2.1.0         
##  [61] generics_0.1.0        jsonlite_1.7.2        dplyr_1.0.7           RCurl_1.98-1.6       
##  [65] magrittr_2.0.2        Matrix_1.3-4          Rcpp_1.0.8            munsell_0.5.0        
##  [69] fansi_1.0.2           viridis_0.6.2         abind_1.4-5           lifecycle_1.0.1      
##  [73] terra_1.5-12          whisker_0.4           stringi_1.7.6         yaml_2.3.5           
##  [77] MASS_7.3-54           grid_4.1.1            parallel_4.1.1        crayon_1.5.0         
##  [81] deldir_1.0-6          lattice_0.20-44       splines_4.1.1         tensor_1.5           
##  [85] pillar_1.7.0          rjson_0.2.21          spatstat.geom_2.3-1   fftw_1.0-6.1         
##  [89] codetools_0.2-18      glue_1.6.2            evaluate_0.15         remotes_2.4.0        
##  [93] png_0.1-7             vctrs_0.3.8           polyclip_1.10-0       gtable_0.3.0         
##  [97] purrr_0.3.4           spatstat.core_2.3-2   assertthat_0.2.1      ggplot2_3.3.5        
##  [ reached getOption(&quot;max.print&quot;) -- omitted 7 entries ]</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
