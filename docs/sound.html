<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>sound.knit</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BOKU bioacoustics R 2022</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="program.html">Program</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_basics.html">R basics</a>
    </li>
    <li>
      <a href="sound.html">Sound</a>
    </li>
    <li>
      <a href="spectrograms.html">Spectrograms</a>
    </li>
    <li>
      <a href="seewave.html">seewave</a>
    </li>
    <li>
      <a href="annotations.html">Annotations</a>
    </li>
    <li>
      <a href="intro_to_warbler.html">Intro to warbleR</a>
    </li>
    <li>
      <a href="ohun.html">ohun: automatic detection</a>
    </li>
    <li>
      <a href="measure_acoustic_structure.html">Measure acoustic structure</a>
    </li>
    <li>
      <a href="comparing_methods.html">Comparing measuring methods</a>
    </li>
    <li>
      <a href="quality_checks.html">Quality checks</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center>
<font size="7"><b>Sound</b></font>
</center></h1>
<h3 class="subtitle"><center>
<font size="4"><b>Analysis of animal acoustic signals in R</b> <br> BOKU International wildlife lectures, 2022</font>
</center></h3>
<h4 class="author"><center>
<font size="3"><a href="http://marceloarayasalas.weebly.com/">Marcelo Araya-Salas, PhD</a></font>
</center></h4>
<h4 class="date"><center>
“2022-03-09”
</center></h4>

</div>


<p> </p>
<p>Sound waves are characterized by compression and expansion of the medium as sound energy moves through it. There is also back and forth motion of the particles making up the medium:</p>
<p><img src="images/wave.gif" alt="wave animation"></p>
<p><font size="3"> taken from <a href="https://dosits.org" class="uri">https://dosits.org</a></font></p>
<p> </p>
<p>The variation in pressure that is perceived at a fixed point in space can be represented by a graph of pressure (amplitude) by time:</p>
<p><img src="images/amplitude.gif" alt="wave and oscillogram"></p>
<p> </p>
<div id="sounds-in-r" class="section level1">
<h1>Sounds in R</h1>
<p>Sound waves can be represented by 3 kinds of R objects:</p>
<ul>
<li>Common classes (numerical vector, numerical matrix)</li>
<li>Time series classes (ts, mts)</li>
<li>Specific sound classes (Wave, sound and audioSample)  </li>
</ul>
<div id="non-specific-classes" class="section level2">
<h2>Non-specific classes</h2>
<div id="vectors" class="section level3">
<h3>Vectors</h3>
<p>Any numerical vector can be treated as a sound if a sampling frequency is provided. For example, a 440 Hz sinusoidal sound sampled at 8000 Hz for one second can be generated like this:</p>
<pre class="r"><code>library(seewave)

# create sinewave at 440 Hz
s1 &lt;- sin(2 * pi * 440 * seq(0, 1, length.out = 8000))

is.vector(s1)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>mode(s1)</code></pre>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p> </p>
<p>These sequences of values only make sense when specifying the sampling rate at which they were created:</p>
<pre class="r"><code>oscillo(s1, f = 8000, from = 0, to = 0.01)</code></pre>
<p><img src="sound_files/figure-html/unnamed-chunk-2-1.png" width="672" />  </p>
</div>
<div id="matrices" class="section level3">
<h3>Matrices</h3>
<p>You can read any single column matrix:</p>
<pre class="r"><code>s2&lt;-as.matrix(s1)

is.matrix(s2)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>dim(s2)</code></pre>
<pre><code>## [1] 8000    1</code></pre>
<pre class="r"><code>oscillo(s2, f = 8000, from = 0, to = 0.01)</code></pre>
<p><img src="sound_files/figure-html/unnamed-chunk-3-1.png" width="672" />  </p>
<p>If the matrix has more than one column, only the first column will be considered:</p>
<pre class="r"><code>x&lt;-rnorm(8000)

s3&lt;-cbind(s2,x)

is.matrix(s3)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>dim(s3)</code></pre>
<pre><code>## [1] 8000    2</code></pre>
<pre class="r"><code>oscillo(s3, f = 8000, from = 0, to = 0.01)</code></pre>
<p><img src="sound_files/figure-html/unnamed-chunk-4-1.png" width="672" />  </p>
</div>
<div id="time-series" class="section level3">
<h3>Time series</h3>
<p>The class <code>ts</code> and related functions <code>ts()</code>, <code>as.ts()</code>, <code>is.ts()</code> can also be used to generate sound objects in R. Here the command to similarly generate a series of time is shown corresponding to a 440 Hz sinusoidal sound sampled at 8000 Hz for one second:</p>
<pre class="r"><code>s4 &lt;- ts(data = s1, start = 0, frequency = 8000)

str(s4)</code></pre>
<pre><code>##  Time-Series [1:8000] from 0 to 1: 0 0.339 0.637 0.861 0.982 ...</code></pre>
<p> </p>
<p>To generate a random noise of 0.5 seconds:</p>
<pre class="r"><code>s4 &lt;- ts(data = runif(4000, min = -1, max = 1), start = 0, end = 0.5, frequency = 8000)

str(s4)</code></pre>
<pre><code>##  Time-Series [1:4001] from 0 to 0.5: -0.11688 -0.22795 0.83405 -0.89194 -0.00618 ...</code></pre>
<p> </p>
<p>The <code>frequency()</code> and <code>deltat()</code> functions return the sampling frequency (<span class="math inline">\(f\)</span>) and the time resolution (<span class="math inline">\(Delta t\)</span>) respectively:</p>
<pre class="r"><code>frequency(s4)</code></pre>
<pre><code>## [1] 8000</code></pre>
<pre class="r"><code>deltat(s4)</code></pre>
<pre><code>## [1] 0.000125</code></pre>
<p> </p>
<p>As the frequency is incorporated into the <code>ts</code> objects, it is not necessary to specify it when used within functions dedicated to audio:</p>
<pre class="r"><code>oscillo(s4, from = 0, to = 0.01)</code></pre>
<p><img src="sound_files/figure-html/unnamed-chunk-8-1.png" width="672" />  </p>
<p>In the case of multiple time series, <strong>seewave</strong> functions will consider only the first series:</p>
<pre class="r"><code>s5 &lt;- ts(data = s3, f = 8000)

class(s5)</code></pre>
<pre><code>## [1] &quot;mts&quot;    &quot;ts&quot;     &quot;matrix&quot;</code></pre>
<pre class="r"><code>oscillo(s5, from = 0, to = 0.01)</code></pre>
<p><img src="sound_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="dedicated-r-classes-for-sound" class="section level2">
<h2>Dedicated R classes for sound</h2>
<p>There are 3 kinds of objects corresponding to the <code>wav</code> binary format or the<code>mp3</code> compressed format:</p>
<ul>
<li><code>Wave</code> class of the package <strong>tuneR</strong></li>
<li><code>sound</code> class of the package <strong>phonTools</strong></li>
<li><code>AudioSample</code> class of the package <strong>audio</strong></li>
</ul>
<p> </p>
<div id="wave-class-tuner" class="section level3">
<h3><code>Wave</code> class (<strong>tuneR</strong>)</h3>
<p>The <code>Wave</code> class comes with the <strong>tuneR</strong> package. This S4 class includes different “slots” with the amplitude data (left or right channel), the sampling frequency (or frequency), the number of bits (8/16/24/32) and the type of sound (mono/stereo). High sampling rates (&gt; 44100 Hz) can be read on these types of objects.</p>
<p>The function to import <code>.wav</code> files from the hard drive is <code>readWave</code>:</p>
<pre class="r"><code># load packages
library(tuneR)

s6 &lt;- readWave(&quot;./examples/Phae.long1.wav&quot;)</code></pre>
<p> </p>
<p>We can verify the class of the object like this:</p>
<pre class="r"><code># object class
class(s6) </code></pre>
<pre><code>## [1] &quot;Wave&quot;
## attr(,&quot;package&quot;)
## [1] &quot;tuneR&quot;</code></pre>
<p> </p>
<p>S4 objects have a structure similar to lists but use ‘@’ to access each position (slot):</p>
<pre class="r"><code># structure
str(s6)</code></pre>
<pre><code>## Formal class &#39;Wave&#39; [package &quot;tuneR&quot;] with 6 slots
##   ..@ left     : int [1:56251] 162 -869 833 626 103 -2 43 19 47 227 ...
##   ..@ right    : num(0) 
##   ..@ stereo   : logi FALSE
##   ..@ samp.rate: int 22500
##   ..@ bit      : int 16
##   ..@ pcm      : logi TRUE</code></pre>
<pre class="r"><code># extract 1 position
s6@samp.rate </code></pre>
<pre><code>## [1] 22500</code></pre>
<p> </p>
<div class="alert alert-warning">
<p>“Pulse-code modulation (PCM) is a method used to digitally represent sampled analog signals. It is the standard form of digital audio. In a PCM stream, the amplitude of the analog signal is sampled regularly at uniform intervals, and each sample is quantized to the nearest value within a range of digital steps” (<a href="https://en.wikipedia.org/wiki/Pulse-code_modulation">Wikipedia</a>).</p>
</div>
<p> </p>
<p>The samples come in the slot ‘<span class="citation">@left</span>’:</p>
<pre class="r"><code># samples
s6@left[1:40]</code></pre>
<pre><code>##  [1]  162 -869  833  626  103   -2   43   19   47  227   -4  205  564  171  457  838 -216   60   76
## [20] -623 -213  168 -746 -248  175 -512  -58  651  -85 -213  586   40 -407  371  -51 -587  -92   94
## [39] -527   40</code></pre>
<p> </p>
<p>The number of samples is given by the duration and the sampling rate.</p>
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li>How can we calculate the duration of the <code>wave</code> object using the information in the object?</li>
</ul>
<p> </p>
<ul>
<li>Extract the first second of audio from the object <code>s6</code> using indexing (and squared brackets)</li>
</ul>
</div>
<p> </p>
<p>An advantage of using <code>readWave()</code> is the ability to read specific segments of sound files, especially useful with long files. This is done using the <code>from</code> and<code>to</code> arguments and specifying the units of time with the <code>units</code> arguments. The units can be converted into “samples”, “minutes” or “hours”. For example, to read only the section that begins in 1s and ends in 5s of the file “Phae.long1.wav”:</p>
<pre class="r"><code>s7 &lt;- readWave(&quot;./examples/Phae.long1.wav&quot;, from = 1, to = 5, units = &quot;seconds&quot;)

s7</code></pre>
<pre><code>## 
## Wave Object
##  Number of Samples:      33751
##  Duration (seconds):     1.5
##  Samplingrate (Hertz):   22500
##  Channels (Mono/Stereo): Mono
##  PCM (integer format):   TRUE
##  Bit (8/16/24/32/64):    16</code></pre>
<p> </p>
<p>The <code>.mp3</code> files can be imported to R although they are imported in<code>Wave</code> format. This is done using the <code>readMP3()</code> function:</p>
<pre class="r"><code>s7 &lt;- readMP3(&quot;./examples/Phae.long1.mp3&quot;)

s7</code></pre>
<pre><code>## 
## Wave Object
##  Number of Samples:      56448
##  Duration (seconds):     2.56
##  Samplingrate (Hertz):   22050
##  Channels (Mono/Stereo): Mono
##  PCM (integer format):   TRUE
##  Bit (8/16/24/32/64):    16</code></pre>
<p> </p>
<p>To obtain information about the object (sampling frequency, number of bits, mono/stereo), it is necessary to use the indexing of S4 class objects:</p>
<pre class="r"><code>s7@samp.rate</code></pre>
<pre><code>## [1] 22050</code></pre>
<pre class="r"><code>s7@bit</code></pre>
<pre><code>## [1] 16</code></pre>
<pre class="r"><code>s7@stereo</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p> </p>
<p>A property that does not appear in these calls is that <code>readWave</code> does not normalize the sound. The values that describe the sound will be included between <span class="math inline">\(\pm2^{bit} - 1\)</span>:</p>
<pre class="r"><code>range(s7@left)</code></pre>
<pre><code>## [1] -32768  32767</code></pre>
<p> </p>
</div>
</div>
<div id="class-sound-phontools" class="section level2">
<h2>Class <code>sound</code> (<strong>phonTools</strong>)</h2>
<p>The <code>loadsound()</code> function of <em>phonTools</em> also imports ‘wave’ sound files into R, in this case as objects of class <code>sound</code>:</p>
<pre class="r"><code>library(phonTools)</code></pre>
<pre><code>## 
## Attaching package: &#39;phonTools&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:seewave&#39;:
## 
##     preemphasis</code></pre>
<pre><code>## The following objects are masked from &#39;package:tuneR&#39;:
## 
##     normalize, play</code></pre>
<pre class="r"><code>s8 &lt;- loadsound(&quot;./examples/Phae.long1.wav&quot;)</code></pre>
<pre><code>## Warning in readChar(soundfile, nchars = 8): truncating string with embedded nuls</code></pre>
<pre class="r"><code>s8</code></pre>
<pre><code>## 
##       Sound Object
## 
##    Read from file:         ./examples/Phae.long1.wav
##    Sampling frequency:     22500  Hz
##    Duration:               2500  ms
##    Number of Samples:      56251</code></pre>
<pre class="r"><code>str(s8)</code></pre>
<pre><code>## List of 5
##  $ filename  : chr &quot;./examples/Phae.long1.wav&quot;
##  $ fs        : int 22500
##  $ numSamples: num 56251
##  $ duration  : num 2500
##  $ sound     : Time-Series [1:56251] from 0 to 2.5: 0.00494 -0.02652 0.02542 0.0191 0.00314 ...
##  - attr(*, &quot;class&quot;)= chr &quot;sound&quot;</code></pre>
<p> </p>
<p>This function only imports files with a dynamic range of 8 or 16 bits.</p>
</div>
<div id="class-audiosample-audio" class="section level2">
<h2>Class <code>audioSample</code> (<strong>audio</strong>)</h2>
<p>The <strong>audio</strong> package is another option to handle <code>.wav</code> files. The sound can be imported using the <code>load.wave()</code> function. The class of the resulting object is <code>audioSample</code> which is essentially a numerical vector (for mono) or a numerical matrix with two rows (for stereo). The sampling frequency and resolution are saved as attributes:</p>
<pre class="r"><code>library(audio)</code></pre>
<pre><code>## 
## Attaching package: &#39;audio&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:phonTools&#39;:
## 
##     play</code></pre>
<pre><code>## The following object is masked from &#39;package:tuneR&#39;:
## 
##     play</code></pre>
<pre class="r"><code>s10 &lt;- load.wave(&quot;./examples/Phae.long1.wav&quot;)

head(s10)</code></pre>
<pre><code>## sample rate: 22500Hz, mono, 16-bits
## [1]  4.9438e-03 -2.6521e-02  2.5421e-02  1.9104e-02  3.1433e-03 -6.1037e-05</code></pre>
<pre class="r"><code>s10$rate</code></pre>
<pre><code>## [1] 22500</code></pre>
<pre class="r"><code>s10$bits</code></pre>
<pre><code>## [1] 16</code></pre>
<p> </p>
<p>The main advantage of the <strong>audio</strong> package is that the sound can be acquired directly within an R session. This is achieved first by preparing a <code>NAs</code> vector and then using the<code>record()</code> function. For example, to obtain a mono sound of 5 seconds sampled at 16 kHz:</p>
<pre class="r"><code>s11 &lt;- rep(NA_real_, 16000*5)

record(s11, 16000, 1)</code></pre>
<p> </p>
<p>A recording session can be controlled by three complementary functions: <code>pause()</code>, <code>rewind()</code>, and <code>resume()</code>.</p>
</div>
<div id="export-sounds-from-r" class="section level2">
<h2>Export sounds from R</h2>
<p>For maximum compatibility with other sound programs, it may be useful to save a sound as a simple <code>.txt</code> file. The following commands will write a “tico.txt” file:</p>
<pre class="r"><code>data(tico)

export(tico, f=22050)</code></pre>
<p> </p>
</div>
<div id="format-.wav" class="section level2">
<h2>Format ‘.wav’</h2>
<p><strong>tuneR</strong> and <strong>audio</strong> have a function to write <code>.wav</code> files: <code>writeWave()</code> and <code>save.wave()</code> respectively. Within <strong>seewave</strong>, the <code>savewav()</code> function, which is based on <code>writeWave()</code>, can be used to save data in <code>.wav</code> format. By default, the object name will be used for the name of the <code>.wav</code> file:</p>
<pre class="r"><code>savewav(tico)</code></pre>
<p> </p>
</div>
<div id="format-.flac" class="section level2">
<h2>Format ‘.flac’</h2>
<p>Free Lossless Audio Codec (FLAC) is a file format for lossless audio data compression. FLAC reduces bandwidth and storage requirements without sacrificing the integrity of the audio source. Audio sources encoded in FLAC are generally reduced in size from 40 to 50 percent. See the flac website for more details (<a href="http://flac.sourceforge.net">flac.sourceforge.net</a>).</p>
<p>The <code>.flac</code> format cannot be used as such with R. However, the <code>wav2flac()</code>function allows you to call the FLAC software directly from the console. Therefore, FLAC must be installed on your operating system. If you have a <code>.wav</code> file that you want to compress in <code>.flac</code>, call:</p>
<pre class="r"><code>wav2flac(file = &quot;./examples/Phae.long1.wav&quot;, overwrite = FALSE)</code></pre>
<p> </p>
<p>To compress a <code>.wav</code> file to a <code>.flac</code> format, the argument <code>reverse = TRUE</code> must be used:</p>
<pre class="r"><code>wav2flac(&quot;Phae.long1.flac&quot;, reverse = TRUE)</code></pre>
<p> </p>
</div>
<div id="play-wave-objects" class="section level2">
<h2>Play <code>wave</code> objects</h2>
<p><code>Wave</code> objects can be played with the <code>play()</code> function of <strong>tuneR</strong>. It may happen that the default players of the <code>play()</code> function are not installed in the operating system. <code>setWavPlayer()</code> can be used to define the command that will be used by <code>play</code>. For example, if <a href="http://audacious-media-player.org">Audacious</a> is the player to use on Linux:</p>
<pre class="r"><code>setWavPlayer(&quot;audacious&quot;)

play(tico)</code></pre>
<p> </p>
<p>The homonymous function of the <strong>audio</strong> package does the same on <code>audioSample</code> objects:</p>
<pre class="r"><code>x &lt;- audioSample(sin(1:8000/10), 8000)

play(x)</code></pre>
<p> </p>
<p>The <strong>seewave</strong> package includes the <code>listen()</code> (based on <code>play()</code> of <strong>tuneR</strong>) function that works similarly, but also accepts all specific and non-specific kinds of sound objects in R and also allows to reproduce segments using the arguments <code>from</code> and<code>to</code>:</p>
<pre class="r"><code>x &lt;- sin(1:160000/10)

listen(x, f = 16000, from = 0, to = 2)</code></pre>
<p> </p>
<p>This table, taken from Sueur (2018), summarizes the functions available to import and export sound files in R. The table is incomplete since it does not mention the functions of the <code>phonTools</code> package:</p>
<p><img src="images/tabla-waves.png" alt="tabla imp exp waves"></p>
<hr />
<p> </p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li><p>How does the sampling rate affect the size of an audio file?</p></li>
<li><p>How does the dynamic range affect the size of an audio file?</p></li>
<li><p>Use the <code>system.time()</code> function to compare the performance of the different functions to import audio files in R. For this use the file “LBH.374.SUR.wav” (Long-billed hermit songs) which lasts about 2 min</p></li>
</ul>
<p>tip: <em>the function <code>Wave()</code> can be used to convert amplitude vectors into wave objects</em></p>
</div>
<p> </p>
<hr />
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li><p>Sueur J, Aubin T, Simonis C. 2008. Equipment review: seewave, a free modular tool for sound analysis and synthesis. Bioacoustics 18(2):213–226.</p></li>
<li><p>Sueur, J. (2018). Sound Analysis and Synthesis with R.</p></li>
<li><p>Sueur J. (2018). I/O of sound with R. seewave package vignette. url: <a href="https://cran.r-project.org/web/packages/seewave/vignettes/seewave_IO.pdf" class="uri">https://cran.r-project.org/web/packages/seewave/vignettes/seewave_IO.pdf</a></p></li>
</ol>
<hr />
<p><font size="4">Session information</font></p>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C               LC_TIME=es_CR.UTF-8       
##  [4] LC_COLLATE=es_ES.UTF-8     LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] audio_0.1-10       phonTools_0.2-2.1  kableExtra_1.3.4   warbleR_1.1.27     NatureSounds_1.0.4
## [6] knitr_1.37         seewave_2.2.0      tuneR_1.3.3.1     
## 
## loaded via a namespace (and not attached):
##  [1] bitops_1.0-7         fs_1.5.0             monitoR_1.0.7        usethis_2.0.1       
##  [5] devtools_2.4.2       webshot_0.5.2        httr_1.4.2           rprojroot_2.0.2     
##  [9] Deriv_4.1.3          tools_4.1.1          bslib_0.2.5.1        utf8_1.2.2          
## [13] R6_2.5.1             ohun_0.1.0           DBI_1.1.1            colorspace_2.0-3    
## [17] withr_2.5.0          gridExtra_2.3        tidyselect_1.1.1     prettyunits_1.1.1   
## [21] processx_3.5.2       moments_0.14         bioacoustics_0.2.8   compiler_4.1.1      
## [25] soundgen_2.2.0       cli_3.2.0            rvest_1.0.1          formatR_1.11        
## [29] xml2_1.3.2           microbenchmark_1.4-7 desc_1.3.0           sass_0.4.0          
## [33] scales_1.1.1         callr_3.7.0          pbapply_1.5-0        proxy_0.4-26        
## [37] dtw_1.22-3           systemfonts_1.0.2    stringr_1.4.0        digest_0.6.29       
## [41] shinyBS_0.61         Sim.DiffProc_4.8     rmarkdown_2.10       svglite_2.0.0       
## [45] pkgconfig_2.0.3      htmltools_0.5.2      sessioninfo_1.1.1    fastmap_1.1.0       
## [49] highr_0.9            rlang_1.0.2          rstudioapi_0.13      jquerylib_0.1.4     
## [53] generics_0.1.0       farver_2.1.0         jsonlite_1.7.2       dplyr_1.0.7         
## [57] RCurl_1.98-1.6       magrittr_2.0.2       Rcpp_1.0.8           munsell_0.5.0       
## [61] fansi_1.0.2          viridis_0.6.2        lifecycle_1.0.1      stringi_1.7.6       
## [65] yaml_2.3.5           MASS_7.3-54          pkgbuild_1.2.0       grid_4.1.1          
## [69] parallel_4.1.1       crayon_1.5.0         ps_1.6.0             pillar_1.7.0        
## [73] rjson_0.2.21         fftw_1.0-6.1         pkgload_1.2.1        glue_1.6.2          
## [77] evaluate_0.15        remotes_2.4.0        vctrs_0.3.8          testthat_3.0.4      
## [81] gtable_0.3.0         purrr_0.3.4          assertthat_0.2.1     cachem_1.0.6        
## [85] ggplot2_3.3.5        xfun_0.30            viridisLite_0.4.0    signal_0.7-7        
## [89] tibble_3.1.6         memoise_2.0.0        Rraven_1.0.13        ellipsis_0.3.2</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
